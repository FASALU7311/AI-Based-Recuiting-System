{% extends "base.html" %}

{% block content %}
<div class="page-header">
    <h1>Recruiter Dashboard</h1>
    <p class="subtitle">Manage candidates and track hiring progress</p>
</div>

<div class="dashboard-stats">
    <div class="stat-card">
        <div class="stat-icon">
            <i class="fas fa-users"></i>
        </div>
        <div class="stat-content">
            <div class="stat-value">{{ applications|length }}</div>
            <div class="stat-label">Total Applications</div>
        </div>
    </div>
    
    <div class="stat-card">
        <div class="stat-icon">
            <i class="fas fa-user-check"></i>
        </div>
        <div class="stat-content">
            <div class="stat-value">{{ applications|selectattr('status', 'equalto', 'Accepted')|list|length }}</div>
            <div class="stat-label">Accepted</div>
        </div>
    </div>
    
    <div class="stat-card">
        <div class="stat-icon">
            <i class="fas fa-user-clock"></i>
        </div>
        <div class="stat-content">
            <div class="stat-value">{{ applications|selectattr('status', 'equalto', 'Pending')|list|length }}</div>
            <div class="stat-label">Pending Review</div>
        </div>
    </div>
    
    <div class="stat-card">
        <div class="stat-icon">
            <i class="fas fa-chart-line"></i>
        </div>
        <div class="stat-content">
            <div class="stat-value">
                {% if applications %}
                    {{ "%.1f"|format(applications|map(attribute='resume_score')|sum / applications|length) }}
                {% else %}
                    0
                {% endif %}
            </div>
            <div class="stat-label">Avg. Resume Score</div>
        </div>
    </div>
</div>

<div class="dashboard-filters">
    <div class="filter-group">
        <label for="status-filter">Filter by Status:</label>
        <select id="status-filter" class="form-control">
            <option value="">All Statuses</option>
            <option value="Pending">Pending</option>
            <option value="Accepted">Accepted</option>
            <option value="Rejected">Rejected</option>
        </select>
    </div>
    
    <div class="filter-group">
        <label for="position-filter">Filter by Position:</label>
        <select id="position-filter" class="form-control">
            <option value="">All Positions</option>
            <option value="Software Engineer">Software Engineer</option>
            <option value="Data Scientist">Data Scientist</option>
            <option value="Product Manager">Product Manager</option>
        </select>
    </div>
    
    <div class="filter-group">
        <button class="btn btn-outline">
            <i class="fas fa-download"></i> Export Data
        </button>
    </div>
</div>

{% if applications %}
<div class="card">
    <div class="card-header">
        <h3>Candidate Applications</h3>
    </div>
    <div class="card-body">
        <div class="table-responsive">
            <table class="data-table">
                <thead>
                    <tr>
                        <th>Candidate</th>
                        <th>Position</th>
                        <th>Resume Score</th>
                        <th>Interview Score</th>
                        <th>Status</th>
                        <th>Date</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {% for app in applications %}
                    <tr>
                        <td>
                            <div class="user-info">
                                <div class="user-avatar">
                                    <i class="fas fa-user-circle"></i>
                                </div>
                                <div class="user-details">
                                    <div class="user-name">{{ app.user.email }}</div>
                                </div>
                            </div>
                        </td>
                        <td>{{ app.job_position }}</td>
                        <td>
                            <div class="score-badge score-{{ 'high' if app.resume_score >= 80 else 'medium' if app.resume_score >= 60 else 'low' }}">
                                {{ "%.2f"|format(app.resume_score) }}
                            </div>
                        </td>
                        <td>
                            {% if app.interview %}
                                <div class="score-badge score-{{ 'high' if app.interview.interview_score >= 80 else 'medium' if app.interview.interview_score >= 60 else 'low' }}">
                                    {{ "%.2f"|format(app.interview.interview_score) }}
                                </div>
                            {% else %}
                                <span class="text-muted">N/A</span>
                            {% endif %}
                        </td>
                        <td>
                            <span class="status-badge status-{{ app.status.lower() }}">{{ app.status }}</span>
                        </td>
                        <td>{{ app.created_at.strftime('%Y-%m-%d') }}</td>
                        <td>
                            <div class="action-buttons">
                                <button class="btn-icon" title="View Details">
                                    <i class="fas fa-eye"></i>
                                </button>
                                <button class="btn-icon" title="Download Resume">
                                    <i class="fas fa-download"></i>
                                </button>
                                {% if app.interview %}
                                <button class="btn-icon" title="View Interview">
                                    <i class="fas fa-video"></i>
                                </button>
                                {% endif %}
                            </div>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>
{% else %}
<div class="empty-state">
    <i class="fas fa-users"></i>
    <h3>No applications found</h3>
    <p>There are no candidate applications at this time.</p>
</div>
{% endif %}

{% endblock %}